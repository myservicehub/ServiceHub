<!DOCTYPE html>
<html>
<head>
    <title>Emergency Login - ServiceHub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 400px; 
            margin: 0 auto; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .success { background: rgba(40, 167, 69, 0.9); color: white; }
        .error { background: rgba(220, 53, 69, 0.9); color: white; }
        .info { background: rgba(23, 162, 184, 0.9); color: white; }
        button {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        button:hover { transform: translateY(-2px); }
        button:active { transform: translateY(0); }
        h1 { 
            color: white; 
            text-align: center; 
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            font-size: 16px;
        }
        .icon { font-size: 20px; margin-right: 8px; }
        .credentials {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <h1>üöÄ ServiceHub Emergency Login</h1>
    <div class="subtitle">Mobile Access Solution</div>
    
    <div class="card">
        <h2>üîß Network Issue Detected</h2>
        <p>The frontend cannot connect to the backend API due to network routing.</p>
        <p><strong>Quick Solution:</strong> Manual authentication token injection</p>
    </div>

    <div class="card">
        <h2>üìã Your Login Credentials</h2>
        <div class="credentials">
            <strong>Email:</strong> john.plumber@gmail.com<br>
            <strong>Password:</strong> Password123!<br>
            <strong>Role:</strong> Tradesperson<br>
            <strong>Status:</strong> ‚úÖ Verified Working
        </div>
    </div>

    <div id="status" class="card">
        <h2>Ready to Login</h2>
        <p>Click the button below to automatically authenticate and access your profile with reviews.</p>
    </div>

    <button onclick="loginAsHomeowner()">
        <span class="icon">üè†</span>Login as Francis (Homeowner) - Test Completed Jobs
    </button>
    
    <button onclick="emergencyLogin()">
        <span class="icon">‚ö°</span>Login as John (Tradesperson) - View Reviews  
    </button>
    
    <button onclick="goToReviews()" style="background: linear-gradient(45deg, #007bff, #0056b3);">
        <span class="icon">‚≠ê</span>Go to My Reviews
    </button>
    
    <button onclick="goToProfile()" style="background: linear-gradient(45deg, #6f42c1, #5a2d91);">
        <span class="icon">üë§</span>Go to My Profile
    </button>
    
    <button onclick="clearAuth()" style="background: linear-gradient(45deg, #dc3545, #c82333);">
        <span class="icon">üö™</span>Logout / Clear Data
    </button>

    <div class="card info">
        <h2>‚ÑπÔ∏è How This Works</h2>
        <p>This emergency login bypasses the network connectivity issue by directly injecting your valid authentication token.</p>
        <p><strong>Features you can test:</strong></p>
        <ul>
            <li>‚úÖ Profile with Reviews tab</li>
            <li>‚úÖ View reviews from homeowners</li>
            <li>‚úÖ Review statistics dashboard</li>
            <li>‚úÖ Complete tradesperson profile</li>
        </ul>
    </div>

    <script>
        function updateStatus(title, type, message) {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `card ${type}`;
            statusDiv.innerHTML = `
                <h2>${getIcon(type)} ${title}</h2>
                <p>${message}</p>
            `;
        }

        function getIcon(type) {
            switch(type) {
                case 'success': return '‚úÖ';
                case 'error': return '‚ùå';
                case 'info': return '‚ÑπÔ∏è';
                default: return 'üîÑ';
            }
        }

        function emergencyLogin() {
            updateStatus('Authenticating...', 'info', 'Setting up emergency authentication...');
            
            try {
                // John's valid JWT token (from backend test)
                const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiOGVlNjVlOS0xMDBiLTQ4N2UtYjMwOC1jYzMyNTYyMzRjMTMiLCJlbWFpbCI6ImpvaG4ucGx1bWJlckBnbWFpbC5jb20iLCJleHAiOjE3NTgxMTM5MTd9.4kx-TpbzXyyrd35JO0D1eHJJYezT4-b_xxh18glKatI';
                
                const user = {
                    id: 'b8ee65e9-100b-487e-b308-cc3256234c13',
                    name: 'John Plumber',
                    email: 'john.plumber@gmail.com',
                    role: 'tradesperson',
                    phone: '+2348012345678',
                    location: 'Lagos, Nigeria',
                    postcode: '100001',
                    trade_categories: ['Plumbing'],
                    company_name: 'John Plumbing Services',
                    average_rating: 4.0,
                    total_reviews: 2,
                    status: 'active'
                };

                // Store authentication data
                localStorage.setItem('token', token);
                localStorage.setItem('user', JSON.stringify(user));
                
                updateStatus('Login Successful!', 'success', 
                    `Welcome ${user.name}! You are now authenticated as a ${user.role}. ` +
                    `You can access your profile, reviews, and all tradesperson features.`);
                
                setTimeout(() => {
                    updateStatus('Ready to Explore', 'success', 
                        'Click any of the buttons above to navigate to different sections of your account.');
                }, 2000);
                
            } catch (error) {
                updateStatus('Authentication Failed', 'error', `Error: ${error.message}`);
            }
        }

        function goToReviews() {
            const token = localStorage.getItem('token');
            if (!token) {
                updateStatus('Not Authenticated', 'error', 'Please login first using the Emergency Login button.');
                return;
            }
            
            updateStatus('Navigating...', 'info', 'Opening your reviews page...');
            setTimeout(() => {
                window.location.href = '/my-received-reviews';
            }, 1000);
        }

        function goToProfile() {
            const token = localStorage.getItem('token');
            if (!token) {
                updateStatus('Not Authenticated', 'error', 'Please login first using the Emergency Login button.');
                return;
            }
            
            updateStatus('Navigating...', 'info', 'Opening your profile with Reviews tab...');
            setTimeout(() => {
                window.location.href = '/profile';
            }, 1000);
        }

        function clearAuth() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            updateStatus('Logged Out', 'info', 'All authentication data cleared. You can login again if needed.');
        }

        // Check current login status on page load
        window.onload = function() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            
            if (token && user) {
                const userData = JSON.parse(user);
                updateStatus('Already Authenticated', 'success', 
                    `Currently logged in as ${userData.name} (${userData.role}). ` +
                    `You can navigate to any section using the buttons above.`);
            }
        };
    </script>
</body>
</html>